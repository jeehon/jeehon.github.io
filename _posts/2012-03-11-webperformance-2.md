---
id: 1092
title: 网站性能优化实战二
date: 2012-03-11T06:36:00+00:00
author: jeehon
layout: post
guid: http://jeehon.info/log/?p=1092
permalink: /2012/03/11/webperformance-2/
categories:
  - PHP
  - wordpress
  - 分享
  - 学习
  - 性能
tags:
  - 优化
  - 精简javascript
  - 网站性能
---
上篇博客介绍了网站性能优化的三个策略：减少HTTP请求数、缓存组件、通过压缩来减少HTTP请求时间。今天接着介绍网站性能优化的策略：

## 将样式表放在顶部、将脚本放在底部

将样式表放在顶部对于加载页面所需的实际时间并没有太多的影响，它影响的是浏览器对这些组件的顺序反应。我们都希望页面能够逐步的加载，希望浏览器能够尽快显示内容，系统给用户提供的视觉反馈能让用户感觉不到页面加载出现问题。而当将样式表放在页面底部时，浏览器会延迟显示任何可视化组件来等待加载位于底部的样式表。此时，页面内容也在进行加载，但是却没有给用户任何可视化的反馈，出现了白屏现象，等样式表加载完毕页面才会显示，也许页面的总加载时间差不多，但是出现白屏对用户来说是很不友好的，所以建议将样式表放在顶部。<!--more-->

像样式表一样，脚本也会遇到类似的问题，但是却建议将脚本放在页面底部。我们知道浏览器下载组件收到并行下载的影响，每个浏览器都有自己的并行下载数，如下图所示：
  
[<img src="http://jeehon.info/log/files/2012/03/http.png" alt="" title="http" width="260" height="230" class="aligncenter size-full wp-image-1093" />](http://jeehon.info/log/files/2012/03/http.png)
  
并行下载可以避免因为某个组件下载过慢而影响其他组件的下载，但是下载脚本时并行下载实际上是被禁用的(因为脚本可能使用document.write来修改页面内容，因此浏览器会等待，以确保页面能够恰当的布局)。这样就会出现一个问题，如果将脚本放在页面顶部或者中部，当开始下载脚本时，其他组件的下载就会被阻塞，当脚本下载完毕之后才会逐渐呈现其后面的内容，这样就会出现白屏或者页面加载缓慢的感觉，是很不好的用户体验，所以建议将脚本放在页面底部。

## 精简JavaScript

上一篇博客介绍了压缩组件，减少HTTP请求时间，精简JavaScript也可以减少HTTP请求时间。我们可以通过去掉JavaScript代码中不必要的空格、注释、回车，来精简JavaScript，[YUI Compressor](http://refresh-sf.com/yui/)是一个比较好的在线精简JavaScript的精简工具，把你的JavaScript代码复制进去，YUI Compressor就会将精简后的代码反馈给你。

精简JavaScript之后代码的可维护性就不高了，所以建议保存精简前的版本，如果做修改就在精简前的版本上修改，发布之前通过精简再发布。[33号铺](http://33pu.net)就对其脚本进行了一些优化，将几个插件脚本和网站的脚本进行了合并，并对合并后的脚本进行了精简。